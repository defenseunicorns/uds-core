/**
 * Copyright 2025 Defense Unicorns
 * SPDX-License-Identifier: AGPL-3.0-or-later OR LicenseRef-Defense-Unicorns-Commercial
 */

 views "ports-protocols" {

  /**
    * @likec4-generated(v1)
    * iKRoYXNo2ShhOTliZDkzM2M2Y2VkNjFkMGNhNTc4NzYyMDllM2UyMmUxZWU4OTY5qmF1dG9MYXlvdXSBqWRpcmVjdGlvbqJUQqF40fyloXk2pXdpZHRozRQZpmhlaWdodM0JBKVub2Rlc94AG6RAZ3IxgqFilM0DqzbNDGPNCFShY8OlYWRtaW6CoWKUzQS5bc0BQMy0oWPCp2VuZHVzZXKCoWKUzQcFdc0BQMy0oWPCpWNsb3VkgqFilM0D080BoM0KeM0GwqFjw6pleHQtYWxlcnRzgqFilM0Obs0DHM0BeMy0oWPCqGV4dC1zaWVtgqFilM0Oic0EB80BQMy0oWPCrWNsb3VkLmNsdXN0ZXKCoWKUzQP7zQHSzQoozQZooWPDtmNsb3VkLmNsdXN0ZXIudWRzLWNvcmWCoWKUzQQjzQIEzQf4zQYOoWPDv2Nsb3VkLmNsdXN0ZXIuZXh0ZXJuYWwtc2VydmljZXOCoWKUzQxlzQUG
    * zQGWzQLEoWPDvGNsb3VkLmNsdXN0ZXIudWRzLWNvcmUuZmFsY2+CoWKUzQqWzQMazQFAzLShY8K9Y2xvdWQuY2x1c3Rlci51ZHMtY29yZS52ZWN0b3KCoWKUzQqlzQQLzQFAzLShY8K7Y2xvdWQuY2x1c3Rlci51ZHMtY29yZS56YXJmgqFilM0GBM0G980BQMy0oWPC2SNjbG91ZC5jbHVzdGVyLnVkcy1jb3JlLmlzdGlvLXN5c3RlbYKhYpTNBqfNBgPNAVnMtKFjwr1jbG91ZC5jbHVzdGVyLnVkcy1jb3JlLnZlbGVyb4KhYpTNCrPNBTrNAUDMtKFjwtkqY2xvdWQuY2x1c3Rlci51ZHMtY29yZS5pc3Rpby1hZG1pbi1nYXRld2F5gqFilM0EkM0CN80Bo8y0oWPC2StjbG91ZC5jbHVzdGVyLnVkcy1jb3JlLmlzdGlvLXRlbmFudC1nYXRld2F5gqFilM0G1s0CNs0Bqcy0
    * oWPCvmNsb3VkLmNsdXN0ZXIudWRzLWNvcmUuZ3JhZmFuYYKhYpTNBLvNA1DNAUDMtKFjwtknY2xvdWQuY2x1c3Rlci51ZHMtY29yZS5nZW5lcmljLWN1c3RvbWVygqFilM0Ids0DKs0Bjsy0oWPC2SFjbG91ZC5jbHVzdGVyLnVkcy1jb3JlLm1vbml0b3JpbmeCoWKUzQS1zQRtzQFJzLShY8K7Y2xvdWQuY2x1c3Rlci51ZHMtY29yZS5sb2tpgqFilM0Isc0FL80BQMy0oWPC2SJjbG91ZC5jbHVzdGVyLnVkcy1jb3JlLmF1dGhzZXJ2aWNlgqFilM0Io80EPM0BVMy0oWPCv2Nsb3VkLmNsdXN0ZXIudWRzLWNvcmUua2V5Y2xvYWuCoWKUzQa5zQOyzQFAzLShY8LZImNsb3VkLmNsdXN0ZXIudWRzLWNvcmUucGVwci1zeXN0ZW2CoWKUzQRLzQc2zQFezLShY8LZL2Nsb3Vk
    * LmNsdXN0ZXIudWRzLWNvcmUua3ViZXJuZXRlcy1jb250cm9sLXBsYW5lgqFilM0Eqs0Ffs0BW8y0oWPC2TBjbG91ZC5jbHVzdGVyLmV4dGVybmFsLXNlcnZpY2VzLmV4dC1sb2tpLXN0b3JhZ2WCoWKUzQyTzQYVzQFAzLShY8LZMmNsb3VkLmNsdXN0ZXIuZXh0ZXJuYWwtc2VydmljZXMuZXh0LXZlbGVyby1zdG9yYWdlgqFilM0Mjc0FOM0BQMy0oWPC2S9jbG91ZC5jbHVzdGVyLmV4dGVybmFsLXNlcnZpY2VzLmV4dC1rZXljbG9hay1kYoKhYpTNDI/NBu7NAUDMtKFjwqVlZGdlc94AGqcxNDVzbGF6g6JjcJGCoXjLQJV0s5JiALChectAd1UxbH4myqFshKF4zQVeoXnNAa2ld2lkdGhNpmhlaWdodBKhcJSSzQFKzLSSzQFKzP6SzQFKzQFoks0BSs0BtaZrOGc2MnCD
    * omNwkYKheMtAnqAxYMmoVKF5y0B3qf45SvOWoWyEoXjNB6mhec0BsKV3aWR0aE2maGVpZ2h0EqFwlJLNA1/MtJLNA1/M/pLNA1/NAWiSzQNfzQG1pzFiNHU4NDWComNwkYKheMtAqTnqG3gZnKF5y0CLzFVCB8/xoXCaks0HkM0CYpLNB6LNAmmSzQe1zQJuks0Hx80CcpLNCWHNAtKSzQnWzQJ/ks0Lec0CrpLNDKfNAtCSzQ4DzQMNks0O2M0DNKZmMXJsdm+ComNwkYKheMtAqWGDtRGzNqF5y0CRkd7CWH7NoXCXks0JPs0CHZLNCpnNAieSzQ3mzQJRks0Qkc0DAZLNEKDNAwWSzRCvzQMKks0Qvs0DD6Y0empzMnWDomNwkYKheM0FRKF5zQaeoWyEoXjNBTyhec0GtqV3aWR0aHCmaGVpZ2h0EqFwl5LNAZ7NCBaSzQGxzQf6ks0Bx80H3JLNAd7NB8OSzQHuzQexks0CAc0H
    * n5LNAhTNB46lYWdkcGuDomNwk4KheM0IHqF5zQYSgqF4zQgjoXnNB46CoXjNBbGhec0H46FshKV3aWR0aACmaGVpZ2h0AKF4zQhFoXnNBzKhcJSS0f8EzQOXksvAeyGZmZmZms0EpZLLwIUnMzMzMzPNBg2S0fylzQcbpnVobXhwaYOiY3CRgqF4zQTMoXnNBp2hbISheM0Ey6F5zQaqpXdpZHRoTaZoZWlnaHQSoXCXks0B4M0HXZLNAa7NB3SSzQF+zQeUks0BYc0Hw5LNAVTNB9iSzQFQzQfyks0BUc0IC6cxbTdlZ3M2g6JjcJGCoXjNBlmhec0GjqFshKF4zQZJoXnNBn+ld2lkdGhNpmhlaWdodBKhcJeSzQNKzQgWks0DR80H+pLNA0HNB9ySzQM0zQfDks0DKs0HsJLNAx3NB56SzQMOzQeOpmN6YXJqcYOiY3CRgqF4zQX1oXnNBsehbISheM0F06F5zQaepXdpZHRozKSm
    * aGVpZ2h0EqFwl5LNAmvNB4aSzQJmzQeiks0CZs0HwJLNAnPNB9qSzQJ+zQfwks0Cj80IA5LNAqHNCBSmb3R4cWM5g6JjcJGCoXjNBmuhec0F8qFshKF4zQZZoXnNBeuld2lkdGhVpmhlaWdodBKhcJeSzQT3zQgWks0E6M0H+JLNBNPNB9iSzQS4zQfDks0ETs0HcJLNA7rNB0uSzQNFzQc7pzE1Y2dxOHCDomNwkYKheM0GW6F5zQY9oWyEoXjNBlShec0GO6V3aWR0aE2maGVpZ2h0EqFwlJLNAzvNB4SSzQOWzQewks0EBc0H55LNBGHNCBWnMXNiMjZsZoOiY3CRgqF4y0CeLSUOhGkdoXnLQIk3ZYML4DKhbISheM0Hg6F5zQNPpXdpZHRoVaZoZWlnaHQSoXCdks0D4M0CcpLNBA/NApmSzQQ/zQLKks0EXc0DAZLNBKLNA4GSzQSGzQOzks0Eks0ERJLNBJnNBJSSzQSvzQSt
    * ks0Eks0E+JLNBH7NBSuSzQRZzQVaks0EM80FgKZlZXhwYzaDomNwkYKheMtAoL8vWmuCh6F5y0CH8P8cpXnMoWyEoXjNCHWhec0DC6V3aWR0aE2maGVpZ2h0EqFwlJLNA1/NAnKSzQNfzQKcks0DX80CzZLNA1/NAvenMW52dThsbIOiY3CRgqF4y0CVfrKwSanWoXnLQIhRy+lyRpihbISheM0FX6F5zQMepXdpZHRoVaZoZWlnaHQSoXCUks0BYs0CcpLNAYPNAuqSzQG8zQO+ks0B3s0EOqcxZXRsZDJng6JjcJGCoXjLQJilVRe7YQShectAiTz/HKV5zKFshKF4zQZeoXnNA0+ld2lkdGhVpmhlaWdodBKhcJqSzQEjzQJykszgzQMYknDNBICSzQEnzQVLks0BXc0Fh5LNAkHNBXWSzQKQzQWHks0Cu80FkZLNAujNBZ2SzQMSzQWqpzFqeWJ3cjmDomNwkYKheMtAlWZfv6i+
    * waF5y0CU90xbH4mzoWyEoXjNBVmhec0FUKV3aWR0aFWmaGVpZ2h0EqFwlJLNAe7NBjuSzQIMzQZnks0CL80GnZLNAk3NBsqmYXV1MWl5g6JjcJGCoXjLQJVtRWS/sd+hectAkJGywYXwGaFshKF4zQVboXnNBDmld2lkdGhVpmhlaWdodBKhcJeSzQFzzQT4ks0BYs0FCpLNAVLNBR6SzQFIzQU0ks0BPc0FTZLNAULNBWaSzQFPzQV+pzEyZHRjemKDomNwkYKheMtAmzChA70ABaF5y0CRY23iJEjDoWyEoXjNB1ehec0Em6V3aWR0aFWmaGVpZ2h0EqFwl5LNAovNBPiSzQLDzQUWks0DBc0FNpLNA0TNBUuSzQNozQVXks0FQc0Fn5LNBkbNBcamNTZnbGQ3g6JjcJGCoXjLQJjT1DbwMzihectAjqT7GKF1yKFshKF4zQZboXnNA9yld2lkdGhVpmhlaWdodBKhcJeSzQH0zQT4
    * ks0B980FFZLNAf/NBTSSzQISzQVLks0CJM0FYJLNAqPNBYuSzQMSzQWupzE5MnI3aG+DomNwkYKheM0J26F5zQUooWyEoXjNCmGhec0EgKV3aWR0aFWmaGVpZ2h0EqFwlJLNBvDNAnKSzQbwzQMnks0G8M0EwJLNBvDNBX2nMXY1ZDA4aYOiY3CRgqF4y0Ck5KB2pbBnoXnLQJOGGSfsVn+hbISheM0KTKF5zQT4pXdpZHRoVaZoZWlnaHQSoXCUks0Id80CcpLNCCbNAyeSzQdwzQTBks0HHM0FfqYxeWdzMDKDomNwkYKheMtAoOHqG3gZnKF5y0CRZ7baGWTVoWyEoXjNCE+hec0EUaV3aWR0aFWmaGVpZ2h0EqFwlJLNA7TNBPiSzQO1zQUhks0Dt80FUpLNA7nNBX2nMTlsd3A4boOiY3CRgqF4y0CiibgHScIooXnLQI/Y/xylecyhbISheM0JRqF5zQQOpXdpZHRoV6ZoZWln
    * aHQSoXCUks0Dds0DtZLNA4DNA96SzQONzQQQks0DmM0EOqcxM2RiZGprg6JjcJGCoXjLQKV4UIHegAKhectAl3bvBYPgpaFshKF4zQtDoXnNBf2ld2lkdGhNpmhlaWdodBKhcJqSzQeQzQX+ks0IWc0GIpLNCb/NBl+SzQryzQaOks0LDM0GkpLNCxTNBoySzQstzQaWks0LUM0Go5LNC3PNBriSzQuTzQbOpzEzdjE2b2eDomNwkYKheMtAqERQgd6AAqF5y0CWUDfVLqkGoWyEoXjNDEGhec0FlKV3aWR0aE2maGVpZ2h0EqFw3AAQks0F4s0CYJLNBfTNAmeSzQYHzQJtks0GGc0CcpLNBz3NAseSzQtdzQIqks0LXc0DWpLQ1s0JOpLQ1s0JOpLNC13NBeKSzQtdzQadks0MOc0GOJLNDNvNBpaSzQz5zQanks0NGM0Gu5LNDTXNBs+nMWg3NzlpboOiY3CRgqF4zQlCoXnNBqWh
    * bISheM0JgqF5zQbFpXdpZHRoQqZoZWlnaHQSoXCaks0EXM0F+5LNBNbNBg6SzQWCzQYoks0GGc0GO5LNB5zNBmuSzQgUzQYNks0Jgc0GlpLNCaXNBqOSzQnIzQa4ks0J580Gzg==
    */
   view overview-ports-protocols extends overview-uds-core {
    title "Namespace Ports and Protocols"

    include enduser -> uds-core.istio-tenant-gateway with {
        title "443/HTTPS"
    }

    include uds-core.istio-tenant-gateway -> uds-core.generic-customer with {
        title "443/HTTPS"
    }

    include uds-core.istio-tenant-gateway -> uds-core.keycloak with {
        title "8080/HTTPS"
    }

    include admin -> uds-core.istio-admin-gateway with {
      title "443/HTTPS"
    }

    include uds-core.istio-admin-gateway -> uds-core.keycloak with {
      title "8080/HTTPS"
    }

    include uds-core.istio-admin-gateway -> uds-core.grafana with {
      title "3000/HTTPS"
    }

    include uds-core.generic-customer -> uds-core.authservice with {
      title "10003/GRPC"
    }

    include uds-core.authservice -> uds-core.keycloak with {
      title "8080/HTTPS"
    }

    include uds-core.falco -> uds-core.loki with {
      title "8080/HTTPS"
    }

    include uds-core.grafana -> uds-core.keycloak with {
      title "8080/HTTPS"
    }

    include uds-core.grafana -> uds-core.monitoring with {
      title "9090/HTTPS"
    }

    include uds-core.grafana -> uds-core.loki with {
      title "8080/HTTPS"
    }

    include uds-core.monitoring -> uds-core.kubernetes-control-plane with {
      title "6443/HTTPS"
    }

    include uds-core.loki -> uds-core.vector with {
      title "8080/HTTPS"
    }

    include uds-core.vector -> uds-core.loki with {
      title "8080/HTTPS"
    }

    include uds-core.pepr-system -> uds-core.kubernetes-control-plane with {
      title "443/6443/HTTPS"
    }

    include uds-core.zarf -> uds-core.kubernetes-control-plane with {
      title "443/HTTPS"
    }

    include uds-core.istio-system -> uds-core.kubernetes-control-plane with {
      title "6443/HTTPS"
    }

    include uds-core.kubernetes-control-plane -> uds-core.pepr-system with {
      title "443/HTTPS"
    }

    include uds-core.kubernetes-control-plane -> uds-core.zarf with {
      title "443/HTTPS  31999/HTTP"
    }

    include uds-core.kubernetes-control-plane -> uds-core.istio-system with {
      title "443/HTTPS"
    }

    include uds-core.keycloak -> cloud.cluster.external-services.ext-keycloak-db with {
      title "5432/SSL"
    }

    include uds-core.loki -> cloud.cluster.external-services.ext-loki-storage with {
      title "443/HTTPS"
    }

    include uds-core.velero -> cloud.cluster.external-services.ext-velero-storage with {
      title "443/HTTPS"
    }
  }

  view indepth-ports-protocols extends indepth-uds-core {
    title "Indepth Architecture Ports and Protocols"

    include
      enduser -> istio-tenant-gateway.external-tenant-loadbalancer with {
        title "443/HTTPS"
      }

    include
      istio-tenant-gateway.external-tenant-loadbalancer -> istio-tenant-gateway.tenant-gw with {
        title "443/HTTPS"
      }

    include
      istio-tenant-gateway.tenant-gw -> istio-tenant-gateway.istio-tenant-ingress-gateway with {
        title "443/HTTPS"
      }

    include
      admin -> istio-admin-gateway.external-admin-loadbalancer with {
        title "443/HTTPS"
      }

    include
      istio-admin-gateway.external-admin-loadbalancer -> istio-admin-gateway.admin-gw with {
        title "443/HTTPS"
      }

    include
      istio-admin-gateway.admin-gw -> istio-admin-gateway.istio-admin-ingress-gateway with {
        title "443/HTTPS"
      }

    include
      istio-tenant-gateway.istio-tenant-ingress-gateway -> cloud.cluster.uds-core.keycloak.keycloak-waypoint with {
        title "8080/HTTPS"
      }

    include
      istio-tenant-gateway.istio-tenant-ingress-gateway -> generic-customer.customer-waypoint with {
        title "443/HTTPS"
      }

    include
      istio-admin-gateway.istio-admin-ingress-gateway -> cloud.cluster.uds-core.keycloak.keycloak-waypoint with {
        title "8080/HTTPS"
      }

    include
      istio-admin-gateway.istio-admin-ingress-gateway -> cloud.cluster.uds-core.grafana.grafana with {
        title "3000/HTTPS"
      }

    include
      cloud.cluster.uds-core.keycloak.keycloak-waypoint -> cloud.cluster.external-services.ext-keycloak-db with {
        title "5432/SSL"
      }

    include
      cloud.cluster.uds-core.authservice.authservice -> cloud.cluster.uds-core.keycloak.keycloak-waypoint with {
        title "8080/HTTPS"
      }

    include
      generic-customer.customer-waypoint -> cloud.cluster.uds-core.authservice.authservice with {
        title "10003/GRPC"
      }

    include
      cloud.cluster.uds-core.grafana.grafana -> cloud.cluster.uds-core.keycloak.keycloak-waypoint with {
        title "8080/HTTPS"
      }

    include
      cloud.cluster.uds-core.grafana.grafana -> monitoring.prometheus with {
        title "9090/HTTPS"
      }

    include
      cloud.cluster.uds-core.grafana.grafana -> loki.loki-gateway with {
        title "8080/HTTPS"
      }

    include
      monitoring.prometheus-operator -> kubernetes-control-plane.api-server with {
        title "6443/HTTPS"
      }

    include
      loki.loki-backend -> cloud.cluster.external-services.ext-loki-storage with {
        title "443/HTTPS"
      }

    include
      loki.loki-read -> cloud.cluster.external-services.ext-loki-storage with {
        title "443/HTTPS"
      }

    include
      loki.loki-write -> cloud.cluster.external-services.ext-loki-storage with {
        title "443/HTTPS"
      }

    include
      cloud.cluster.uds-core.vector.vector -> loki.loki-gateway with {
        title "8080/HTTPS"
      }

    include
      cloud.cluster.uds-core.velero.velero -> cloud.cluster.external-services.ext-velero-storage with {
        title "443/HTTPS"
      }

    include
      cloud.cluster.uds-core.falco.falcosidekick -> loki.loki-gateway with {
        title "8080/HTTPS"
      }

    include
      pepr-system.pepr-watcher -> kubernetes-control-plane.api-server with {
        title "6443/HTTPS"
      }

    include
      pepr-system.pepr-admission -> kubernetes-control-plane.pepr-mutation-webhook with {
        title "443/HTTPS"
      }

    include
      pepr-system.pepr-admission -> kubernetes-control-plane.pepr-validating-webhook with {
        title "443/HTTPS"
      }

    include
      zarf.zarf-agent -> kubernetes-control-plane.zarf-mutating-webhook with {
        title "443/HTTPS"
      }

    include
      zarf.zarf-registry -> kubernetes-control-plane.kubelet with {
        title "31999/HTTP"
      }

    include
      istio-system.istiod -> kubernetes-control-plane.api-server with {
        title "6443/HTTPS"
      }

    include
      kubernetes-control-plane.istio-mutating-webhook -> istio-system.istiod with {
        title "443/HTTPS"
      }

    include
      kubernetes-control-plane.zarf-mutating-webhook -> zarf.zarf-agent with {
        title "443/HTTPS"
      }

    include
      kubernetes-control-plane.kubelet -> zarf.zarf-registry with {
        title "31999/HTTP"
      }

    include
      kubernetes-control-plane.pepr-mutation-webhook -> pepr-system.pepr-admission with {
        title "443/HTTPS"
      }

    include
      kubernetes-control-plane.pepr-validating-webhook -> pepr-system.pepr-admission with {
        title "443/HTTPS"
      }

    include
      loki.loki-gateway -> loki.loki-read with {
        title "3100/TCP"
      }

    include
      loki.loki-gateway -> loki.loki-write with {
        title "3100/TCP"
      }

    include
      loki.loki-gateway -> loki.loki-backend with {
        title "3100/TCP"
      }

    include
      loki.loki-read -> loki.loki-backend with {
        title "3100/TCP"
      }

    include
      loki.loki-write -> loki.loki-backend with {
        title "3100/TCP"
      }

    include
      loki.loki-backend -> loki.loki-read with {
        title "3100/TCP"
      }

    include
      monitoring.prometheus -> monitoring.kube-state-metrics with {
        title "443/HTTPS"
      }

    include
      monitoring.prometheus -> monitoring.node-exporter with {
        title "9100/HTTPS"
      }

    include
      monitoring.prometheus -> monitoring.alertmanager with {
        title "9093/HTTPS"
      }
  }

  view loki-ports-protocols extends indepth-ports-protocols {
    title "Loki Ports and Protocols"

    // Clear all includes from the parent view
    exclude
      *,
      admin,
      enduser,
      cloud.cluster.external-services.ext-keycloak-db,
      cloud.cluster.external-services.ext-velero-storage,
      ext-siem,
      ext-alerts

    // Include only Loki relationships
    include
      loki.*,
      cloud.cluster.uds-core.grafana.*,
      cloud.cluster.uds-core.falco.*,
      cloud.cluster.uds-core.vector.*,
      cloud.cluster.external-services.ext-loki-storage
  }
}
