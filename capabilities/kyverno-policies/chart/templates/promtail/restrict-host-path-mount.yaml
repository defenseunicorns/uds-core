apiVersion: kyverno.io/v2alpha1
kind: PolicyException
metadata:
  name: promtail-restrict-host-path-mount
  namespace: kyverno
spec:
  exceptions:
    - policyName: restrict-host-path-mount
      ruleNames:
        - restrict-hostpath-dirs
  match:
    any:
      - resources:
          namespaces:
            - promtail
          names:
            - promtail-promtail*

  # Promtail mounts the following hostPaths:
  # - `/var/log/pods`: to tail pod logs
  # - `/var/lib/docker/containers`: to tail container logs
  # - `/run/promtail`: for Promtail's buffering and persistent state
  # Since logs can have sensitive information, it is better to exclude
  # Promtail from the policy than add the paths as allowable mounts
