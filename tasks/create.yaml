# yaml-language-server: $schema=https://raw.githubusercontent.com/defenseunicorns/uds-cli/v0.0.8-alpha/tasks.schema.json

tasks:
  - name: all
    actions:
      - task:
          name: standard-package
      - task:
          name: istio-only-package
      - task:
          name: example-bundles

  - name: standard-package
    actions:
      - description: "Build the UDS Core Pepr Module"
        cmd: |
          npm ci
          npx pepr build

      - description: "Create the UDS Core Standard Zarf Package"
        cmd: "zarf package create packages/standard --confirm"

  - name: istio-only-package
    actions:
      - description: "Build the UDS Core Pepr Module (Istio Only)"
        cmd: |
          npm ci
          CAPABILITY=istio npx pepr build

      - description: "Create the UDS Core Istio Zarf Package"
        cmd: "zarf package create packages/istio-only --confirm"

  - name: example-bundles
    actions:
      - description: "Create the UDS Core Standard Example Bundle"
        cmd: "uds create examples/k3d-standard --confirm --no-progress"

      - description: "Create the UDS Core Istio Only Example Bundle"
        cmd: "uds create examples/k3d-istio-only --confirm --no-progress"
