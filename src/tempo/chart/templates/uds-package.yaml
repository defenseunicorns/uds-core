apiVersion: uds.dev/v1alpha1
kind: Package
metadata:
  name: tempo
  namespace: {{ .Release.Namespace }}
spec:
  network:
    allow:
      # Permit intra-namespace communication for internal tempo read/write
      - direction: Ingress
        remoteGenerated: IntraNamespace

      - direction: Egress
        remoteGenerated: IntraNamespace

      - direction: Ingress
        podLabels:
          app.kubernetes.io/name: tempo
        remoteNamespace: grafana
        remotePodLabels:
          app.kubernetes.io/name: grafana
        port: 3100
        description: "Grafana Datasource"

      - direction: Ingress
        podLabels:
          app.kubernetes.io/name: tempo
        remoteNamespace: ""
        port: 9411
        description: "Traces"

      - direction: Ingress
        podLabels:
          app.kubernetes.io/name: tempo
        remoteNamespace: monitoring
        remotePodLabels:
          app.kubernetes.io/name: prometheus
        ports:
          - 3100
          - 16687
        description: "Prometheus Metrcis"
