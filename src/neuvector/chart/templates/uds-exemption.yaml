apiVersion: uds.dev/v1alpha1
kind: Exemption
metadata:
  name: neuvector
  namespace: uds-policy-exemptions
spec:
  exemptions:
    - policies:
        - Disallow_Host_Namespaces
        - Disallow_Privileged
        - Require_Non_Root_User
        - Drop_All_Capabilities
        - Restrict_HostPath_Write
        - Restrict_Volume_Types
      matcher:
        namespace: neuvector
        name: "^neuvector-enforcer-pod.*"
      title: "neuvector-enforcer-pod exemptions"
      description: "Neuvector requires HostPath volume types
          Neuvector mounts the following hostPaths:
          `/var/neuvector`: (as writable) for Neuvector's buffering and persistent state
          `/var/run`: communication to docker daemon
          `/proc`: monitoring of processes for malicious activity
          `/sys/fs/cgroup`: important files the controller wants to monitor for malicious content
          https://github.com/neuvector/neuvector-helm/blob/master/charts/core/templates/enforcer-daemonset.yaml#L108"

    - policies:
        - Disallow_Privileged
        - Require_Non_Root_User
        - Drop_All_Capabilities
        - Restrict_HostPath_Write
        - Restrict_Volume_Types
      matcher:
        namespace: neuvector
        name: "^neuvector-controller-pod.*"
      title: "neuvector-controller-pod exemptions"
      description: "Neuvector requires HostPath volume types. 
          Neuvector mounts the following hostPaths:
          `/var/neuvector`: (as writable) for Neuvector's buffering and persistent state
          `/var/run`: communication to docker daemon
          `/proc`: monitoring of processes for malicious activity
          `/sys/fs/cgroup`: important files the controller wants to monitor for malicious content
          https://github.com/neuvector/neuvector-helm/blob/master/charts/core/templates/enforcer-daemonset.yaml#L108"

    - policies:
        - Drop_All_Capabilities
      matcher:
        namespace: neuvector
        name: "^neuvector-prometheus-exporter-pod.*"
      title: "neuvector-prometheus-exporter-pod exemptions"
