# Copyright 2025 Defense Unicorns
# SPDX-License-Identifier: AGPL-3.0-or-later OR LicenseRef-Defense-Unicorns-Commercial

apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  name: clusterconfig.uds.dev
spec:
  conversion:
    strategy: None
  group: uds.dev
  names:
    kind: ClusterConfig
    listKind: ClusterConfigList
    plural: clusterconfig
    shortNames:
      - clusterconfig
    singular: clusterconfig
  scope: Namespaced
  versions:
    - name: v1alpha1
      schema:
        openAPIV3Schema:
          properties:
            spec:
              properties:
                attributes:
                  properties:
                    clusterName:
                      description: Friendly name to associate with your UDS cluster
                      type: string
                    tags:
                      description: Tags to apply to your UDS cluster
                      items:
                        type: string
                      type: array
                  required:
                    - clusterName
                    - tags
                  type: object
                expose:
                  properties:
                    adminDomain:
                      description: Domain all cluster services on the admin gateawy will be exposed on
                      type: string
                    caCert:
                      description: MICAH HALP
                      type: string
                    domain:
                      description: Domain all cluster services will be exposed on
                      type: string
                  required:
                    - domain
                    - adminDomain
                    - caCert
                  type: object
                logLevel:
                  enum:
                    - debug
                    - info
                    - warn
                    - error
                  type: string
                networking:
                  properties:
                    kubeapiCIDR:
                      description: MICAH HALP
                      type: string
                    kubenodeCIDRS:
                      description: MICAH HALP
                      items:
                        pattern: ^(([0-9]{1,3}\.){3}[0-9]{1,3}\/[0-9]+)|(([a-fA-F0-9:]+:+)+[a-fA-F0-9:]+(/[0-9]+)?)$
                        type: string
                      type: array
                  required:
                    - kubeapiCIDR
                    - kubenodeCIDRS
                  type: object
                policy:
                  properties:
                    allowAllNsExemptions:
                      description: Allow exemptions to live in any namespace
                      type: boolean
                  required:
                    - allowAllNsExemptions
                  type: object
              required:
                - attributes
                - networking
                - expose
                - policy
                - logLevel
              type: object
          required:
            - spec
          type: object
      served: true
      storage: true
