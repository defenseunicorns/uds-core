kind: ZarfPackageConfig
metadata:
  name: farmer-pickles
  url: https://welovebob.com/characters/farmer_pickles.htm
  image: https://welovebob.com/Images/characters/farmer_pickles.jpg
  description: "A zarf package to deploy things"

components:
  - name: deploy
    required: true
    actions:
      onCreate:
        before:
          - description: Deploy the cluster bundle
            cmd: |
                ARCH=$(uname -m)
                [ "$ARCH" = "x86_64" ] && ARCH="amd64"
                ./uds deploy oci://ghcr.io/zachariahmiller/k3d-common:0.1.0-$ARCH --no-progress --confirm
            dir: ../build
          - description: Deploy the bundle
            cmd: |
                ARCH=$(uname -m)
                [ "$ARCH" = "x86_64" ] && ARCH="amd64"
                ./uds d ../build/uds-bundle-name-0.1.0-$ARCH.tar.zst  --no-progress --confirm #${COMPONENTS}          
          - description: Inject tls certificate
            cmd: |
              npm ci
              npx --yes ts-node secret.ts
            dir: ../../../gw-tls


